<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MA'RIFA - –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –£—á–∏—Ç–µ–ª—å</title>
    <link rel="stylesheet" href="style.css" />

    <style>
      .onboarding-page {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .onboarding-container {
        max-width: 700px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 30px;
        padding: 60px 50px;
        text-align: center;
        box-shadow: 0 30px 70px rgba(138, 74, 95, 0.25);
      }

      .welcome-arabic {
        font-family: "Amiri", serif;
        font-size: 4rem;
        color: #2d1b4e;
        margin-bottom: 30px;
      }

      .welcome-title {
        font-family: "Cormorant Garamond", serif;
        font-size: 3rem;
        color: #8a4a5f;
        margin-bottom: 40px;
      }

      .start-btn {
        display: inline-block;
        padding: 20px 60px;
        background: linear-gradient(135deg, #d4a574, #c1955e);
        color: #2d1b4e;
        border-radius: 50px;
        text-decoration: none;
        font-size: 1.3rem;
        font-weight: 600;
        margin-top: 40px;
        transition: 0.3s;
        border: none;
        cursor: pointer;
      }

      .start-btn:hover {
        transform: scale(1.05);
        color: white;
      }
    </style>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700;800&family=Cormorant+Garamond:wght@400;500;600;700;800&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="background-image"></div>
    <div class="background-overlay"></div>

    <div class="onboarding-page">
      <div class="onboarding-container">
        <div class="welcome-arabic">Ÿ±ŸÑÿ≥ŸéŸëŸÑŸéÿßŸÖŸè ÿπŸéŸÑŸéŸäŸíŸÉŸèŸÖŸí</div>
        <h1 class="welcome-title" id="teacherTitle">
          –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –£—á–∏—Ç–µ–ª—å!
        </h1>

        <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 30px">
          –í–∞—à–∞ –±–ª–∞–≥–æ—Ä–æ–¥–Ω–∞—è –º–∏—Å—Å–∏—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–Ω–∞–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è.<br />
          –ù–∞—á–Ω–∏—Ç–µ —Å —á–∏—Å—Ç–æ–≥–æ –Ω–∞–º–µ—Ä–µ–Ω–∏—è, –∏ –ê–ª–ª–∞—Ö –±–ª–∞–≥–æ—Å–ª–æ–≤–∏—Ç –≤–∞—à —Ç—Ä—É–¥.
        </p>

        <div
          style="
            background: rgba(212, 165, 116, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
          "
        >
          <p style="font-style: italic; font-size: 1.3rem">
            "–õ—É—á—à–∏–π –∏–∑ –≤–∞—Å ‚Äî –∏–∑—É—á–∞—é—â–∏–π –ö–æ—Ä–∞–Ω –∏ –æ–±—É—á–∞—é—â–∏–π –µ–º—É –¥—Ä—É–≥–∏—Ö"
          </p>
          <p style="margin-top: 10px; color: #d4a574">‚Äî –ê–ª—å-–ë—É—Ö–∞—Ä–∏</p>
        </div>

        <p style="font-size: 1.1rem; line-height: 1.6; color: #4a4048">
          –ö–∞–∫ <strong>ÿ≠ŸéÿßŸÖŸêŸÑŸè ÿßŸÑŸíÿπŸêŸÑŸíŸÖŸê</strong> (–Ω–µ—Å—É—â–∏–π –∑–Ω–∞–Ω–∏–µ), –≤—ã –±–µ—Ä—ë—Ç–µ –Ω–∞
          —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å<br />
          –∑–∞ –ø–µ—Ä–µ–¥–∞—á—É –∏—Å–∫—É—Å—Å—Ç–≤–∞ —Ç–∞–¥–∂–≤–∏–¥–∞ –Ω–æ–≤—ã–º –ø–æ–∫–æ–ª–µ–Ω–∏—è–º.
        </p>

        <button class="start-btn" id="startTeachingBtn">
          <i class="fas fa-chalkboard-teacher"></i> –û—Ç–∫—Ä—ã—Ç—å –∫–∞–±–∏–Ω–µ—Ç
          –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
        </button>
      </div>
    </div>

    <script src="auth.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        console.log("üöÄ Onboarding –¥–ª—è —É—á–∏—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω");

        // 1. –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = Auth.getUser();
        console.log("üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑ localStorage:", user);

        // 2. –ï—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
        if (!user) {
          console.log("‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");
          alert("–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–π–¥–∏—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é!");
          window.location.href = "register-teacher.html";
          return;
        }

        // 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–ª—å
        if (user.role !== "teacher") {
          console.log("‚ö†Ô∏è –≠—Ç–æ –Ω–µ —É—á–∏—Ç–µ–ª—å, –∞:", user.role);
          alert("–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π!");
          window.location.href = "register-teacher.html";
          return;
        }

        // 4. –ï—Å–ª–∏ —É–∂–µ –ø—Ä–æ—à–µ–ª onboarding - —Å—Ä–∞–∑—É –≤ –õ–ö
        if (user.onboardingCompleted === true) {
          console.log("‚úÖ –£–∂–µ –ø—Ä–æ—à–µ–ª onboarding, —Å—Ä–∞–∑—É –≤ –õ–ö");
          window.location.href = "teacher-dashboard.html";
          return;
        }

        // 5. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è
        if (user.name) {
          document.getElementById("teacherTitle").textContent =
            "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, " + user.name + "!";
        }

        // 6. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ - –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô!
        document
          .getElementById("startTeachingBtn")
          .addEventListener("click", function () {
            console.log('üñ± –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å –∫–∞–±–∏–Ω–µ—Ç" –Ω–∞–∂–∞—Ç–∞!');

            // –°–æ–∑–¥–∞–µ–º –ö–û–ü–ò–Æ –æ–±—ä–µ–∫—Ç–∞ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Ñ–ª–∞–≥–æ–º
            const updatedUser = {
              role: user.role,
              name: user.name,
              email: user.email,
              level: user.level,
              registered: user.registered,
              onboardingCompleted: true, // –æ–±–Ω–æ–≤–ª—è–µ–º —Ñ–ª–∞–≥
              isTeacher: user.isTeacher || true,
            };

            console.log("üìù –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:", updatedUser);

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –¥–∞–Ω–Ω—ã–µ
            const saved = Auth.saveUser(updatedUser);

            if (saved) {
              console.log("üíæ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!");
              console.log(
                "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:",
                localStorage.getItem("marifa_user")
              );

              // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
              this.innerHTML =
                '<i class="fas fa-check"></i> –£—Å–ø–µ—à–Ω–æ! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...';
              this.style.background = "#4CAF50";
              this.disabled = true;

              // –ü–µ—Ä–µ—Ö–æ–¥–∏–º —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
              setTimeout(() => {
                console.log("üîÑ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ teacher-dashboard.html");
                window.location.href = "teacher-dashboard.html";
              }, 1000);
            } else {
              console.error("‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è!");
              alert("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.");
            }
          });

        // 7. –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ Enter
        document.addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            document.getElementById("startTeachingBtn").click();
          }
        });
      });
    </script>
  </body>
</html>
